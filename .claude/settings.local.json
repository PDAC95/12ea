{
  "permissions": {
    "allow": [
      "Bash(git init:*)",
      "Bash(git branch:*)",
      "Bash(git remote add:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "Bash(test:*)",
      "Bash(tree:*)",
      "Bash(find:*)",
      "Bash(npm install:*)",
      "Bash(npx vite --version)",
      "Bash(npx tailwindcss --help:*)",
      "Bash(cat:*)",
      "Bash(timeout 5 node:*)",
      "Bash(netstat:*)",
      "Bash(findstr:*)",
      "Bash(taskkill:*)",
      "Bash(cmd //c \"taskkill /PID 29976 /F\")",
      "Bash(node src/scripts/test-email.js:*)",
      "Bash(node test-email-simple.js:*)",
      "Bash(node:*)",
      "Bash(del test-user-model.js)",
      "Bash(node test-token-service.js:*)",
      "Bash(node test-auth-middleware.js:*)",
      "Bash(node test-validators.js:*)",
      "Bash(node test-resend-debug.js:*)",
      "Bash(npm run dev:*)",
      "Bash(timeout:*)",
      "Bash(timeout 10 npm run dev:*)",
      "Bash(cmd //c \"taskkill /PID 173396 /F\")",
      "Bash(cmd //c \"taskkill /PID 11096 /F\")",
      "Bash(git log:*)",
      "Bash(dir /b)",
      "Bash(npm run build:*)",
      "Bash(npm run test:business:*)",
      "Bash(npm run seed:business:*)",
      "Bash(npm run test:service:*)",
      "Bash(curl:*)",
      "Bash(python:*)",
      "Bash(npm run seed:services:*)",
      "Bash(dir:*)",
      "Bash(npm run seed:registrations:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6eyJpZCI6IjY5MTI1M2VkMTBlMzM3NmJhOGU4ODM2NiIsImVtYWlsIjoiZGV2QGphcHBpLmNhIiwicm9sZSI6ImFkbWluIn0sInR5cGUiOiJhdXRoIiwiaWF0IjoxNzYzMDUwMzUyLCJleHAiOjE3NjM2NTUxNTJ9.tzYxS7q4cGTqtBVBWs4WcDzlIxjufCa2u1Wn7NBd8GQ\")",
      "Bash(cmd //c \"taskkill /F /IM node.exe /T\")",
      "Bash(npm run seed:events:*)",
      "Bash(npm run seed:blog:*)",
      "Bash(nul)",
      "Bash(npm run seed:users:*)",
      "Bash(npm run seed:admin:*)",
      "Bash(cmd //c \"taskkill /PID 122564 /F\")",
      "Bash(cmd //c \"taskkill /PID 26248 /F\")",
      "Bash(npm run admin:create:*)",
      "Bash(cmd //c \"taskkill /F /PID 94316\")",
      "Bash(cmd //c \"taskkill /PID 964 /F\")",
      "Bash(cmd //c \"taskkill /F /PID 63724\")",
      "Bash(cmd //c \"taskkill /F /PID 54660\")",
      "Bash(cmd //c \"taskkill /F /PID 1916\")",
      "Bash(cmd //c \"taskkill /F /PID 132124\")",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY5MTI1M2VkMTBlMzM3NmJhOGU4ODM2NiIsInR5cCI6ImF1dGgiLCJlbWFpbCI6ImRldkBqYXBwaS5jYSIsInJvbGUiOiJhZG1pbiIsImlzVmVyaWZpZWQiOnRydWUsImlhdCI6MTc2MzE1MzgwNiwiZXhwIjoxNzYzNzU4NjA2fQ.x7h2PIljzbCJqZDIpHx8piuNlJ4b9mEDtcMAP-1FA7w\")",
      "Bash(git reset:*)",
      "Bash(.env.example)",
      "Bash(npm run preview:email:*)",
      "Bash(start email-preview-verification.html)",
      "Bash(npm run preview:email:welcome:*)",
      "Bash(start email-preview-welcome.html)",
      "Bash(nslookup:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY5MWNiNzU0N2IxMmZmNjdiOWE4MzllNSIsInR5cGUiOiJhdXRoIiwiZW1haWwiOiJhZG1pbkBlbnRyZWFtaWdhcy5jb20iLCJyb2xlIjoiYWRtaW4iLCJpc1ZlcmlmaWVkIjp0cnVlLCJpYXQiOjE3NjM0ODk2NTcsImV4cCI6MTc2NDA5NDQ1N30.3T4vi8OsjEYjgxXj0W5OZgiP_W7jmj8WQaDi044sZ18\")",
      "Bash(cmd //c \"taskkill /PID 82392 /F\")",
      "Bash(cmd //c \"taskkill /PID 54040 /F\")",
      "Bash(cmd //c \"taskkill /PID 83060 /F\")",
      "Bash(cmd //c \"taskkill /PID 76008 /F\")",
      "Bash(del test-url-validation.js test-url-validation-api.js)",
      "Bash(cmd //c \"taskkill /PID 11752 /F\")",
      "Bash(del test-url-validation.js)",
      "Bash(cmd //c \"taskkill /F /PID 80308\")",
      "Bash(cmd //c \"taskkill /PID 158948 /F\")",
      "Bash(cmd //c \"taskkill /F /PID 54864\")",
      "Bash(cmd //c \"taskkill /F /PID 113860\")",
      "Bash(del C:dev12eabackendtest-admin-token.js)",
      "SlashCommand(/mernfrontend)",
      "Bash(cmd //c \"taskkill /PID 14304 /F\")",
      "Bash(cmd //c \"taskkill /F /PID 169440\")",
      "Bash(npm run migrate:approve-old-businesses:*)",
      "Bash(cmd //c \"taskkill /F /PID 18668\")",
      "SlashCommand(/qa Ejecuta un test completo del módulo de Negocios (Business) en ambos lados: cliente y administrador.\n\n## CONTEXTO DEL SISTEMA\n- Frontend: http://localhost:5173\n- Backend API: http://localhost:8000/api/v1\n- Usuario Admin: dev@jappi.ca / Password123\n- Base de datos: MongoDB (entreamigas-dev)\n\n## CAMBIOS RECIENTES QUE DEBES VALIDAR\n1. Se sincronizaron las categorías entre frontend y backend (17 categorías totales)\n2. Se eliminó el campo \"owner\" del formulario de registro (ahora se asigna automáticamente desde el usuario autenticado)\n3. Se corrigieron los toast notifications (parámetros en orden correcto)\n4. Se migró el status de negocios antiguos a 'approved'\n\n## SCOPE DEL TEST - MÓDULO DE NEGOCIOS\n\n### PARTE 1: VISTA PÚBLICA (Cliente/Usuario Regular)\n\n#### 1.1 Directorio de Negocios Públicos\n**URL**: http://localhost:5173/businesses\n\n**Tests a realizar**:\n- [ ] Verificar que se muestran TODOS los negocios con status 'approved' (debe haber 43+ negocios)\n- [ ] Verificar que NO se muestran negocios con status 'pending' o 'rejected'\n- [ ] Probar filtros:\n  - [ ] Búsqueda por texto (nombre del negocio)\n  - [ ] Filtro por categoría (probar con cada una de las 17 categorías)\n  - [ ] Filtro por ciudad\n- [ ] Verificar paginación (si aplica)\n- [ ] Verificar que cada card de negocio muestra:\n  - [ ] Logo (si existe)\n  - [ ] Nombre del negocio\n  - [ ] Categoría con badge de color\n  - [ ] Descripción\n  - [ ] Ciudad\n  - [ ] Información de contacto (teléfono, email, redes sociales)\n- [ ] Verificar enlaces externos:\n  - [ ] Website se abre en nueva pestaña\n  - [ ] Instagram redirige correctamente\n  - [ ] WhatsApp/Teléfono funciona\n\n#### 1.2 Registro de Nuevo Negocio (Propuesta)\n**Ubicación**: Modal \"Agregar Mi Negocio\" desde el directorio\n\n**Pre-requisito**: Debes estar autenticado como usuario regular (NO admin)\n\n**Tests de UI**:\n- [ ] Verificar que el modal se abre correctamente\n- [ ] Verificar que el campo \"Nombre de la Dueña\" NO está presente (fue eliminado)\n- [ ] Verificar que todos los campos requeridos están marcados con asterisco (*)\n- [ ] Verificar placeholders en cada input\n\n**Tests de Validación Frontend (React Hook Form + Yup)**:\n- [ ] Nombre del negocio: requerido, max 100 caracteres\n- [ ] Categoría: requerida, debe ser una de las 17 opciones\n- [ ] Descripción: requerida, mínimo 50 caracteres, max 500 caracteres\n- [ ] Teléfono: requerido, formato válido (10-20 caracteres con números, espacios, guiones)\n- [ ] Ciudad: requerida\n- [ ] Email: opcional, formato email válido\n- [ ] Website: opcional, formato URL válido\n- [ ] Instagram: opcional, formato @usuario válido\n- [ ] Dirección: opcional\n\n**Tests de Upload de Logo**:\n- [ ] Intentar subir archivo mayor a 5MB → debe mostrar toast error \"El logo no puede ser mayor a 5MB\"\n- [ ] Intentar subir archivo que no sea JPG/PNG/WEBP → debe mostrar toast error \"El logo debe ser JPG, PNG o WEBP\"\n- [ ] Subir logo válido → debe mostrar preview\n- [ ] Remover logo → preview desaparece\n\n**Tests de Categorías - CRÍTICO**:\nProbar registro con cada una de estas categorías (elegir al menos 5 aleatorias):\n- [ ] Gastronomía\n- [ ] Belleza y Bienestar\n- [ ] Salud\n- [ ] Fitness\n- [ ] Consultoría\n- [ ] Moda y Accesorios\n- [ ] Servicios del Hogar\n- [ ] Artesanías\n- [ ] Fotografía y Video\n- [ ] Educación y Tutorías\n- [ ] Tecnología\n- [ ] Entretenimiento\n- [ ] Deportes\n- [ ] Automotriz\n- [ ] Bienes Raíces\n- [ ] Seguros\n- [ ] Trámites y Gestorías\n\n**Tests de Validación Backend (Express-Validator)**:\n- [ ] Enviar formulario con categoría INVÁLIDA (si es posible desde DevTools) → debe retornar 400\n- [ ] Enviar formulario sin token de autenticación → debe retornar 401\n- [ ] Verificar que el backend recibe los datos correctamente (revisar logs en consola del servidor)\n\n**Tests de Envío Exitoso**:\n- [ ] Llenar formulario con datos válidos + logo\n- [ ] Enviar formulario\n- [ ] Debe mostrar toast SUCCESS: \"¡Gracias! Tu negocio será revisado por nuestro equipo\"\n- [ ] Modal debe cerrarse automáticamente\n- [ ] El negocio NO debe aparecer inmediatamente en el directorio público (status pending)\n\n**Tests de Manejo de Errores**:\n- [ ] Desconectar backend → enviar formulario → debe mostrar toast ERROR con mensaje apropiado\n- [ ] Enviar formulario sin algunos campos requeridos → verificar mensajes de error específicos\n\n---\n\n### PARTE 2: PANEL DE ADMINISTRACIÓN\n\n#### 2.1 Login Admin\n**URL**: http://localhost:5173/admin/login\n**Credenciales**: dev@jappi.ca / Password123\n\n**Tests**:\n- [ ] Login exitoso\n- [ ] Redirección a /admin/dashboard\n- [ ] Token JWT guardado correctamente\n\n#### 2.2 Dashboard Admin - Negocios Pendientes\n**URL**: http://localhost:5173/admin/businesses/pending\n\n**Tests de Listado**:\n- [ ] Verificar que se muestran SOLO negocios con status 'pending'\n- [ ] Verificar que cada negocio pendiente muestra:\n  - [ ] Logo (si existe)\n  - [ ] Nombre del negocio\n  - [ ] Categoría\n  - [ ] Descripción\n  - [ ] Información de contacto\n  - [ ] Ciudad/dirección\n  - [ ] Nombre de quien lo envió (owner.preferredName o owner.fullName)\n  - [ ] Fecha de envío (createdAt)\n  - [ ] Botones: \"Aprobar\" y \"Rechazar\"\n\n**Tests de Estados**:\n- [ ] Si NO hay negocios pendientes → mostrar mensaje \"No hay negocios pendientes de aprobación\"\n- [ ] Si hay error de red → mostrar mensaje de error\n- [ ] Loading state mientras carga\n\n#### 2.3 Aprobación de Negocio\n\n**Pre-requisito**: Debe haber al menos 1 negocio pendiente (registrar uno en PARTE 1.2)\n\n**Tests de Flujo de Aprobación**:\n- [ ] Click en botón \"Aprobar\" de un negocio pendiente\n- [ ] Debe abrir modal de confirmación con:\n  - [ ] Nombre del negocio\n  - [ ] Mensaje de confirmación\n  - [ ] Botones \"Cancelar\" y \"Aprobar Negocio\"\n- [ ] Click en \"Cancelar\" → modal se cierra, negocio sigue pendiente\n- [ ] Click en \"Aprobar Negocio\":\n  - [ ] Debe mostrar loading state\n  - [ ] Debe mostrar toast SUCCESS: \"Negocio '[nombre]' aprobado exitosamente\"\n  - [ ] Modal se cierra\n  - [ ] Negocio desaparece de la lista de pendientes\n  - [ ] Lista se actualiza automáticamente\n\n**Tests de Verificación Post-Aprobación**:\n- [ ] Ir al directorio público (http://localhost:5173/businesses)\n- [ ] El negocio recién aprobado DEBE aparecer en la lista pública\n- [ ] Verificar que todos los datos se muestran correctamente\n\n**Tests de Backend**:\n- [ ] Verificar en logs del servidor que se ejecuta la aprobación\n- [ ] Verificar que se actualiza: status='approved', approvedAt=Date, approvedBy=adminId\n\n#### 2.4 Rechazo de Negocio\n\n**Tests de Flujo de Rechazo**:\n- [ ] Click en botón \"Rechazar\" de un negocio pendiente\n- [ ] Debe abrir modal con:\n  - [ ] Nombre del negocio\n  - [ ] TextArea para \"Razón del rechazo\"\n  - [ ] Botones \"Cancelar\" y \"Rechazar Negocio\"\n- [ ] Intentar rechazar sin escribir razón → debe mostrar toast WARNING: \"La razón del rechazo debe tener al menos 10 caracteres\"\n- [ ] Escribir razón con menos de 10 caracteres → mismo error\n- [ ] Escribir razón válida (10+ caracteres) y confirmar:\n  - [ ] Debe mostrar loading state\n  - [ ] Debe mostrar toast SUCCESS: \"Negocio '[nombre]' rechazado\"\n  - [ ] Modal se cierra\n  - [ ] Negocio desaparece de la lista de pendientes\n  - [ ] Lista se actualiza automáticamente\n\n**Tests de Verificación Post-Rechazo**:\n- [ ] El negocio rechazado NO debe aparecer en el directorio público\n- [ ] Verificar en backend que status='rejected' y rejectionReason está guardada\n\n#### 2.5 Gestión General de Negocios (Admin)\n**URL**: Posiblemente http://localhost:5173/admin/businesses\n\n**Tests**:\n- [ ] Verificar que el admin puede ver TODOS los negocios (approved, pending, rejected)\n- [ ] Verificar filtros por status\n- [ ] Verificar búsqueda\n- [ ] Verificar acciones disponibles para admin\n\n---\n\n### PARTE 3: TESTS DE INTEGRACIÓN Y EDGE CASES\n\n#### 3.1 Flujo Completo Usuario → Admin → Público\n1. [ ] Registrar nuevo negocio como usuario regular\n2. [ ] Verificar que aparece como pending en admin\n3. [ ] Aprobar desde admin\n4. [ ] Verificar que aparece en directorio público\n5. [ ] Verificar que todos los datos coinciden\n\n#### 3.2 Tests de Autorización\n- [ ] Intentar acceder a /admin/businesses/pending sin estar autenticado → redirect a login\n- [ ] Intentar acceder como usuario regular (no admin) → debe denegar acceso\n- [ ] Intentar hacer POST a /api/v1/businesses/propose sin token → 401\n- [ ] Intentar aprobar negocio sin ser admin → 403\n\n#### 3.3 Tests de Datos\n- [ ] Verificar que negocios con caracteres especiales se manejan correctamente (ñ, á, é, etc.)\n- [ ] Verificar que URLs con protocolo https:// funcionan\n- [ ] Verificar que URLs sin protocolo (ejemplo.com) se manejan correctamente\n- [ ] Verificar Instagram con @ y sin @\n- [ ] Verificar teléfonos con diferentes formatos: (123) 456-7890, +1 123 456 7890, 1234567890\n\n#### 3.4 Tests de Performance\n- [ ] Con 43+ negocios aprobados, verificar que el directorio carga en menos de 3 segundos\n- [ ] Verificar que las imágenes de logos cargan correctamente\n- [ ] Verificar que no hay memory leaks al abrir/cerrar modales múltiples veces\n\n#### 3.5 Tests de Toast Notifications\n**CRÍTICO - Verificar que TODOS los toasts tienen parámetros correctos**:\n- [ ] ProposeBusinessModal línea 69: showToast('error', 'El logo no puede ser mayor a 5MB')\n- [ ] ProposeBusinessModal línea 77: showToast('error', 'El logo debe ser JPG, PNG o WEBP')\n- [ ] ProposeBusinessModal línea 139: showToast('success', '¡Gracias!...')\n- [ ] ProposeBusinessModal línea 147: showToast('error', errorMessage)\n- [ ] BusinessApproval línea 72: showToast('success', 'Negocio aprobado...')\n- [ ] BusinessApproval línea 77: showToast('error', error.message)\n- [ ] BusinessApproval línea 100: showToast('warning', 'La razón...')\n- [ ] BusinessApproval línea 107: showToast('success', 'Negocio rechazado')\n- [ ] BusinessApproval línea 113: showToast('error', error.message)\n\nVerificar que NO hay errores de PropTypes en la consola del navegador.\n\n---\n\n## FORMATO DEL REPORTE\n\nGenera un reporte con la siguiente estructura:\n\n```markdown\n# REPORTE QA - MÓDULO DE NEGOCIOS\nFecha: [fecha]\nTester: QA Agent\n\n## RESUMEN EJECUTIVO\n- Total de tests ejecutados: X\n- Tests pasados: X\n- Tests fallados: X\n- Bugs críticos: X\n- Bugs menores: X\n- Estado general: ✅ PASS / ❌ FAIL\n\n## PARTE 1: VISTA PÚBLICA\n### 1.1 Directorio de Negocios\n- [✅/❌] Test 1: Descripción\n  - Resultado: ...\n  - Error (si aplica): ...\n\n### 1.2 Registro de Negocio\n...\n\n## PARTE 2: PANEL ADMIN\n...\n\n## PARTE 3: INTEGRACIÓN\n...\n\n## BUGS ENCONTRADOS\n\n### BUG #1 - [CRÍTICO/ALTO/MEDIO/BAJO]\n**Título**: Descripción corta\n**Ubicación**: Archivo:línea o URL\n**Pasos para reproducir**:\n1. ...\n2. ...\n**Resultado esperado**: ...\n**Resultado actual**: ...\n**Logs/Screenshots**: ...\n**Prioridad**: ...\n\n### BUG #2\n...\n\n## RECOMENDACIONES\n- ...\n\n## CONCLUSIÓN\n...\n```\n\n## NOTAS IMPORTANTES PARA EL QA\n- Revisar logs del backend en la terminal mientras haces los tests\n- Revisar consola del navegador para errores de JS/React\n- Hacer capturas de pantalla de cualquier error visual\n- Probar en modo incógnito para evitar cache\n- Si encuentras errores 400, revisar el cuerpo de la respuesta para ver qué campo falló en validación\n- Prestar especial atención a los tests de categorías - esto era el bug principal)",
      "SlashCommand(/qa:*)",
      "Bash(cmd //c \"taskkill /F /PID 117868\")",
      "Bash(npm run admin:set:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY5MWY4ZjczYTQwNjY3M2U2ODlkYTA0YiIsInR5cGUiOiJhdXRoIiwiZW1haWwiOiJkZXZAamFwcGkuY2EiLCJyb2xlIjoidXNlciIsImlzVmVyaWZpZWQiOnRydWUsImlhdCI6MTc2NDM2MjczNSwiZXhwIjoxNzY0OTY3NTM1fQ.Ru3OahuoXIU2314CjoKFiP2roHMFKte1i-YZHJAwrjs\")",
      "Bash(__NEW_LINE__ curl -s -X POST http://localhost:8000/api/v1/tips/my/propose )",
      "Bash(__NEW_LINE__ echo \"TEST 2: GET /api/v1/tips (listar públicos)\")",
      "Bash(ADMIN_TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY5MWY4ZjczYTQwNjY3M2U2ODlkYTA0YiIsInR5cGUiOiJhdXRoIiwiZW1haWwiOiJkZXZAamFwcGkuY2EiLCJyb2xlIjoiYWRtaW4iLCJpc1ZlcmlmaWVkIjp0cnVlLCJpYXQiOjE3NjQzNjMxMTMsImV4cCI6MTc2NDk2NzkxM30.FxM47yw3eQAxw1onE962B0fxJvi3c9ClboMJg8okVfE\")",
      "Bash(__NEW_LINE__ echo \"=========================================\")",
      "Bash(del backendsrccontrollerstipController.js)",
      "Bash(rm:*)",
      "Bash(mv:*)",
      "Bash(git restore:*)",
      "Bash(__NEW_LINE__ curl -X POST http://localhost:8000/api/v1/tips/my/propose )",
      "Bash(__NEW_LINE__ echo \"=== TEST 1: Título muy corto (debe fallar) ===\")",
      "Bash(__NEW_LINE__ echo -e \"\\n\\n=== TEST 2: Título válido (debe pasar) ===\")",
      "Bash(cmd /c \"taskkill /F /PID 281192\")",
      "Bash(cmd /c \"taskkill /F /IM node.exe /T\")",
      "Bash(cmd /c \"taskkill /F /PID 158556\")",
      "Bash(cmd /c \"taskkill /F /PID 25052\")"
    ]
  },
  "enableAllProjectMcpServers": true,
  "enabledMcpjsonServers": [
    "git",
    "filesystem",
    "mongodb",
    "playwright"
  ]
}
